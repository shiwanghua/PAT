# 08-31

（有bug，还好没看出来）

四则运算

输入字符串 `(1+2)*3`
输出 9

```
#include <iostream>
#include <vector>
#include <stack>

int getANumber(const std::string &s, int &i)
{
    int a = 0;
    while (i < s.length() && isdigit(s[i]))
    {
        a += s[i] - '0';
        i++;
    }
    return a;
}

int calculation(std::string s)
{
    int ans = 0, a;
    std::stack<int> st;
    int pn = 0;
    for (int i = 0; i < s.length();)
    {
        if (s[i] == '(' || isdigit(s[i]))
        {
            if (s[i] == '(')
                i++;
            a = getANumber(s, i);
            st.push(a);
            pn += 1;
        }
        else if (s[i] == '+' || s[i] == '-')
        {
            if (s[i] == '-')
                a = -1;
            else
                a = 1;
            a = a * getANumber(s, ++i);
            int t = st.top();
            st.push(a);
            pn += 1;
        }
        else if (s[i] == '*')
        {
            a = getANumber(s, ++i);
            int t = st.top();
            st.pop();
            st.push(a * t);
        }
        else if (s[i] == '/')
        {
            a = getANumber(s, ++i);
            int t = st.top();
            assert(t != 0);
            st.pop();
            st.push(t / a);
        }
        else // ')'
        {
            i++;
            int t = 0;
            while (pn--)
            {
                t += st.top();
                st.pop();
            }
            st.push(t);
            pn=0;
        }
    }
    while (st.empty() == false)
    {
        ans += st.top();
        st.pop();
    }
    return ans;
}

int main()
{
    std::string s = "1+2*3";
    std::cout << calculation(s) << "\n";

    return 0;
}
```

之前没维护 `pn`，导致 `1+2*3` 输出 9，然后 debug 了下加入了 pn

pn统计了当前括号里有多少项需要相加，等做完乘法除法运算后相加

还有bug就是运算符后面不能有左括号、不支持嵌套括号。。

遇到左括号需要递归处理

#09-08 二三面 100min

感动了，突然觉得 
https://shuiyuan.sjtu.edu.cn/t/topic/83766
https://shuiyuan.sjtu.edu.cn/t/topic/83763 

不值得，那天3小时两场笔试，花了两小时到虹软上面，星环只一小时。


下午4点二面三面连着，二面做了两个力扣题，直接发链接要我在网站上做就行！没问什么面经，介绍了项目和简历。

第一题字典树，一年多以前做过

https://leetcode.cn/problems/implement-trie-prefix-tree/

![图片说明](https://uploadfiles.nowcoder.com/images/20220908/793394141_1662634293415/12F66C653795C8C810D9827BC04D3C18 "图片标题") 

第二题没做过，要求都是O（1）复杂度，还跟我解释说否则就是个easy题了。

https://leetcode.cn/problems/design-a-stack-with-increment-operation/

![图片说明](https://uploadfiles.nowcoder.com/images/20220908/793394141_1662634312228/AE52E1F4DECEC95066CFB63FD222BCBF "图片标题") 

想了好久，最后incre还是写了个暴力，通过后面试官说这个p用了和没用没什么区别，

![图片说明](https://uploadfiles.nowcoder.com/images/20220908/793394141_1662634338819/7BC6AC250B117390036A0169D241BB5A "图片标题") 

我说了两个优化，维护map再pop时做加法，用树状数组或线段树维护前缀区间上的加法，

但还是不是O（1）的，后来面试官提示说pop时这个p可以加到前一个上面。。

![图片说明](https://uploadfiles.nowcoder.com/images/20220908/793394141_1662634359026/6795AFBD32A3C9A137C677DD706405CF "图片标题") 

两种解法都出错了好几次，而且由于用例很多只能**肉眼debug**（面试官还吐槽了），上面还不是所有试错，“执行代码”不提交还报错了几次。

三面为难了好几个面经，反正都得问到底，问到没了，感觉都没答到点上，还有好几次被反问我还傻傻的坚持，明知是错的

模板的优缺点，有什么用，还有吗？

tcp怎么保证可靠，还有呢

发一个报文就会收到一个ack吗？发4个tcp报文，会收到4个ack吗？

好像正确答案应该是收到一个ack序列号是100的话，100之前的就都确认了，尽管99可能没收到，累积确认

全局变量初始化为0和非零，在存储区方面有什么区别

seq是怎么变化的？每次加一？是吗？你确定？
加报文长度

类成员声明为static，除了共享，还有什么用？

面试官为难我这么多，最后我问有啥方向，他说大数据、云计算、智能我三个方向都行